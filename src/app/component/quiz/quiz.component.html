<div class="quizContainer">
  <form [formGroup]="quizForm" *ngIf="quizForm">
    <div formArrayName="queList">
      <ngb-carousel
        #carousel
        [showNavigationArrows]="false"
        [showNavigationIndicators]="false"
        [interval]="0"
        [keyboard]="false"
        [ngStyle]="{'width': isMobileView ? '100%' : '80%', 'margin': 'auto'}"
      >
        <ng-template
          ngbSlide
          *ngFor="let que of queList().controls; let i = index"
        >
          <ng-container [formGroupName]="i">
            <div class="m-3">
              <div class="card quiz-card h-auto">
                <div
                  class="card-header py-0 px-3 d-flex flex-row align-items-center justify-content-between position-relative"
                >
                  <div
                    class="h5 user-select-none col-md-3 col-lg-3 col-sm-3"
                  >
                    {{ quizInfo?.title }}
                  </div>
                  <div
                    class="h5 user-select-none timer d-flex col-auto align-items-center justify-content-between rounded-2 w-auto"
                  >
                      <i class="mr-10 bi bi-clock"></i>
                      <input class="h5 user-select-none" type="text" formControlName="timer" readonly class="timer-input">
                    <!-- </div> -->
                  </div>
                </div>

                <div class="card-body d-inline-block rounded-2 p-3">
                  <span class="h6 user-select-none">
                    {{ "Q-" + (i + 1) }} {{ subRandomQueList.questions[i]["question"] }}
                    <p class="h6 small"> {{ subRandomQueList.questions[i].type === 'checkbox' ? "( You can select multiple options )" : subRandomQueList.questions[i].type === 'radio' ? "( You can select only one option )" : '' }} </p>
                  </span>

                  <ng-container *ngIf="subRandomQueList.questions[i].type !== 'code' else writeCode">
                    <ng-container
                      *ngFor="let card of subRandomQueList.questions[i].options;">
                      <div class="mx-0">
                        <label
                          class="h6 small option p-10 mt-3 w-100 rounded-2 align-items-center user-select-none"
                          (click)="onSelectAnswer(card, i)"
                          [class.hightlight-selected]="checkSelected(card.id)"
                        >
                          {{ card.label }}
                        </label>
                      </div>
                    </ng-container>
                  </ng-container>

                  <ng-template #writeCode>
                    <ngx-monaco-editor
                      [options]="editorOptions"
                      formControlName="userCode"
                      style="height: 300px; width: 100%;"
                    ></ngx-monaco-editor>

                    <button type="button" class="mr-10 common-btn btn-next" style="width: 15%">
                      Run Code
                    </button>

                    <!-- <div *ngIf="!!output">
                      <h4>Output:</h4>
                      <pre>{{ output }}</pre>
                    </div> -->
                  </ng-template>
                </div>

                <div
                  class="d-flex flex-row card-footer py-0 px-3 justify-content-between align-items-center w-100"
                >
                  <div class="h6 w-50">
                    <strong>{{ i + 1 }}</strong> Of <strong>{{ subRandomQueList.questions.length }}</strong> Questions
                  </div>

                    <div class="d-flex flex-row justify-content-end w-50 text-end">
                      <ng-container *ngIf="i + 1 == 1">
                        <button (click)="exitFromQuiz()" type="button" class="mr-10 common-btn btn-exit"> Exit </button>
                      </ng-container>

                      <ng-container *ngIf="i + 1 != 1">
                        <button
                          (click)="previous(i)"
                          type="button"
                          class="mr-10 common-btn btn-back"
                        >
                          Previous
                        </button>
                      </ng-container>

                      <button
                        type="button"
                        [disabled]="getFormControlItem()[i].controls['next'].value"
                        (click)="skip(subRandomQueList.questions[i], i)"
                        class="mr-10 common-btn btn-skip"
                      >
                        Skip
                      </button>

                      <button
                        type="button"
                        (click)="next(i)"
                        class="mr-10 common-btn btn-next"
                      >
                        {{ subRandomQueList.questions.length != i + 1 ? "Next" : "Submit" }}
                      </button>
                    </div>
                </div>
              </div>
            </div>
          </ng-container>
        </ng-template>
      </ngb-carousel>
    </div>
  </form>

  <ng-template #content let-modal>
    <div class="modal-header">
      <span class="h5 modal-title">
        Test Completion Confirmation
      </span>
      <button
        type="button"
        class="btn-close"
        aria-label="Close"
        (click)="modal.dismiss('Cross click')"
      ></button>
    </div>
    <div class="modal-body">
      <p>Congratulations! You have successfully completed the test. Thank you for your participation and effort. If you have any questions or concerns, please feel free to reach out to our support team.!&hellip;</p>
      <div>Great job</div>
    </div>
  </ng-template>
</div>
